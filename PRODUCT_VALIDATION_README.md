# ระบบการล็อคข้อมูลสินค้า (Product Validation System)

## ภาพรวม
ระบบนี้ถูกออกแบบมาเพื่อป้องกันปัญหาที่ลูกค้าสั่งซื้อสินค้าโดยไม่ระบุข้อมูลที่จำเป็นครบถ้วน เช่น ไม่เลือกหน่วยสินค้า หรือไม่เลือกตัวเลือกที่จำเป็น

## คุณสมบัติหลัก

### 1. การตรวจสอบหน่วยสินค้า (Unit Validation)
- **บังคับเลือก**: หากสินค้ามีหน่วยให้เลือก (เช่น ชิ้น, กล่อง, เมตร) ลูกค้าจะต้องเลือกหน่วยก่อนเพิ่มลงตะกร้า
- **แสดงข้อความแจ้งเตือน**: แสดงข้อความ "กรุณาเลือกหน่วยสินค้าก่อนเพิ่มลงตะกร้า" หากยังไม่ได้เลือก
- **ไฮไลท์ฟิลด์**: ฟิลด์ที่ยังไม่ได้เลือกจะแสดงด้วยสีแดงและพื้นหลังสีแดงอ่อน

### 2. การตรวจสอบตัวเลือกสินค้า (Product Options Validation)
- **บังคับเลือกครบถ้วน**: หากสินค้ามีตัวเลือก (เช่น สี, ขนาด, รุ่น) ลูกค้าจะต้องเลือกทุกตัวเลือกก่อนเพิ่มลงตะกร้า
- **แสดงข้อความแจ้งเตือน**: แสดงข้อความ "กรุณาเลือก [ชื่อตัวเลือก] ก่อนเพิ่มลงตะกร้า" สำหรับตัวเลือกที่ยังไม่ได้เลือก
- **ตรวจสอบความพร้อมใช้งาน**: ตรวจสอบว่าตัวเลือกที่เลือกยังมีสินค้าหรือไม่

### 3. การตรวจสอบจำนวนสินค้า (Quantity Validation)
- **จำนวนขั้นต่ำ**: ต้องเลือกจำนวนสินค้าอย่างน้อย 1 ชิ้น
- **แสดงข้อความแจ้งเตือน**: แสดงข้อความ "กรุณาเลือกจำนวนสินค้าอย่างน้อย 1 ชิ้น" หากจำนวนไม่ถูกต้อง

### 4. การตรวจสอบสถานะสินค้า (Product Availability)
- **สินค้าหมด**: ป้องกันการเพิ่มสินค้าที่หมดแล้วลงตะกร้า
- **แสดงข้อความแจ้งเตือน**: แสดงข้อความ "สินค้านี้หมดแล้ว ไม่สามารถสั่งซื้อได้"

## การทำงานในแต่ละหน้า

### หน้าแสดงรายละเอียดสินค้า (`/products/[id]`)
- ปุ่ม "เพิ่มลงตะกร้า" จะถูก disable เมื่อข้อมูลไม่ครบถ้วน
- แสดงข้อความแจ้งเตือนใต้แต่ละฟิลด์ที่ยังไม่ได้เลือก
- ฟิลด์ที่ยังไม่ได้เลือกจะแสดงด้วยสีแดง

### หน้าแสดงสินค้าทั้งหมด (`/shop`)
- ปุ่ม "เพิ่มลงตะกร้า" จะถูก disable เมื่อข้อมูลไม่ครบถ้วน
- แสดงข้อความแจ้งเตือนใน modal เมื่อข้อมูลไม่ครบถ้วน
- ฟิลด์ที่ยังไม่ได้เลือกจะแสดงด้วยสีแดง

## โครงสร้างข้อมูล

### Product Interface
```typescript
interface Product {
  _id: string;
  name: string;
  price: number;
  description: string;
  imageUrl: string;
  category?: string;
  isAvailable?: boolean;
  units?: {
    label: string;
    price: number;
    multiplier?: number;
    shippingFee?: number;
  }[];
  options?: {
    name: string;
    values: {
      label: string;
      imageUrl?: string;
      isAvailable?: boolean;
    }[];
  }[];
}
```

### CartItem Interface
```typescript
interface CartItem {
  productId: string;
  name: string;
  price: number;
  quantity: number;
  selectedOptions?: Record<string, string>;
  unitLabel?: string;
  unitPrice?: number;
}
```

## ฟังก์ชันการตรวจสอบ

### `isFormValid()`
ตรวจสอบว่าฟอร์มมีข้อมูลครบถ้วนหรือไม่:
- ตรวจสอบสถานะสินค้า
- ตรวจสอบการเลือกหน่วย
- ตรวจสอบการเลือกตัวเลือก
- ตรวจสอบจำนวนสินค้า

### `getValidationMessage()`
ส่งคืนข้อความแจ้งเตือนที่เหมาะสมตามสถานะการตรวจสอบ

## การแสดงผล

### สถานะปุ่ม
- **ปกติ**: สีน้ำเงิน พร้อมใช้งาน
- **Disabled**: สีเทา ไม่สามารถใช้งานได้
- **ข้อความ**: แสดงข้อความแจ้งเตือนที่เหมาะสม

### สถานะฟิลด์
- **ปกติ**: เส้นขอบสีเทา พื้นหลังสีขาว
- **ผิดพลาด**: เส้นขอบสีแดง พื้นหลังสีแดงอ่อน
- **ข้อความแจ้งเตือน**: แสดงใต้ฟิลด์ด้วยสีแดง

## การใช้งาน

### สำหรับลูกค้า
1. เลือกสินค้าที่ต้องการ
2. เลือกหน่วยสินค้า (หากมี)
3. เลือกตัวเลือกสินค้า (หากมี)
4. ระบุจำนวนสินค้า
5. กดปุ่ม "เพิ่มลงตะกร้า"

### สำหรับผู้ดูแลระบบ
1. ตั้งค่าหน่วยสินค้าในระบบจัดการสินค้า
2. ตั้งค่าตัวเลือกสินค้าและค่าที่เป็นไปได้
3. ตั้งค่าสถานะความพร้อมใช้งานของสินค้าและตัวเลือก

## ประโยชน์

1. **ลดข้อผิดพลาด**: ลูกค้าไม่สามารถสั่งซื้อสินค้าโดยไม่ระบุข้อมูลที่จำเป็น
2. **เพิ่มความชัดเจน**: แสดงข้อความแจ้งเตือนที่ชัดเจนว่าต้องทำอะไร
3. **ปรับปรุงประสบการณ์**: ลูกค้าเข้าใจขั้นตอนการสั่งซื้อได้ดีขึ้น
4. **ลดการติดต่อ**: ลดการติดต่อจากลูกค้าเพื่อขอข้อมูลเพิ่มเติม

## การปรับแต่ง

ระบบสามารถปรับแต่งได้โดย:
- เปลี่ยนข้อความแจ้งเตือน
- เปลี่ยนสีและสไตล์การแสดงผล
- เพิ่มการตรวจสอบเพิ่มเติม
- ปรับแต่งกฎการตรวจสอบ

## การทดสอบ

ระบบควรได้รับการทดสอบในกรณีต่างๆ:
- สินค้าที่ไม่มีหน่วยหรือตัวเลือก
- สินค้าที่มีหน่วยแต่ไม่มีตัวเลือก
- สินค้าที่มีตัวเลือกแต่ไม่มีหน่วย
- สินค้าที่มีทั้งหน่วยและตัวเลือก
- สินค้าที่หมดแล้ว
- ตัวเลือกที่หมดแล้ว
