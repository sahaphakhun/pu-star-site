# р╕гр╕░р╕Ър╕Ър╕кр╕гр╣Йр╕▓р╕З PDF р╣Гр╕Ър╣Ар╕кр╕Щр╕нр╕гр╕▓р╕Др╕▓ - WinRich Dynamic Service

## ЁЯОп р╕ар╕▓р╕Юр╕гр╕зр╕б

р╕гр╕░р╕Ър╕Ър╕кр╕гр╣Йр╕▓р╕З PDF р╣Гр╕Ър╣Ар╕кр╕Щр╕нр╕гр╕▓р╕Др╕▓р╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ър╕ар╕▓р╕йр╕▓р╣Др╕Чр╕вр╣Бр╕ер╕░р╕бр╕╡р╕Фр╕╡р╣Др╕Лр╕Щр╣Мр╕Чр╕╡р╣Ир╕кр╕зр╕вр╕Зр╕▓р╕б р╣Гр╕Кр╣Й Puppeteer р╣Гр╕Щр╕Бр╕▓р╕гр╣Бр╕Ыр╕ер╕З HTML р╣Ар╕Ыр╣Зр╕Щ PDF

## тЬи Features

### ЁЯОи р╕Бр╕▓р╕гр╕нр╕нр╕Бр╣Бр╕Ър╕Ъ
- **Font р╕ар╕▓р╕йр╕▓р╣Др╕Чр╕в**: р╣Гр╕Кр╣Й Sarabun font р╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ър╕ар╕▓р╕йр╕▓р╣Др╕Чр╕вр╕нр╕вр╣Ир╕▓р╕Зр╕кр╕бр╕Ър╕╣р╕гр╕Ур╣М
- **р╕Фр╕╡р╣Др╕Лр╕Щр╣Мр╕кр╕зр╕вр╕Зр╕▓р╕б**: р╣Гр╕Кр╣Й gradient, shadow, р╣Бр╕ер╕░р╕кр╕╡р╕Чр╕╡р╣Ир╕Чр╕▒р╕Щр╕кр╕бр╕▒р╕в
- **Responsive Layout**: р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Юр╕┤р╕бр╕Юр╣Мр╣Бр╕ер╕░р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕Ър╕Щр╕лр╕Щр╣Йр╕▓р╕Ир╕н
- **Logo**: р╕бр╕╡р╣Вр╕ер╣Вр╕Бр╣Йр╕Ър╕гр╕┤р╕йр╕▒р╕Чр╣Гр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ъ SVG

### ЁЯМР р╕Бр╕▓р╕гр╕гр╕нр╕Зр╕гр╕▒р╕Ър╕ар╕▓р╕йр╕▓
- **р╕ар╕▓р╕йр╕▓р╣Др╕Чр╕в**: р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕ар╕▓р╕йр╕▓р╣Др╕Чр╕вр╕нр╕вр╣Ир╕▓р╕Зр╕кр╕бр╕Ър╕╣р╕гр╕Ур╣М
- **р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕зр╕▒р╕Щр╕Чр╕╡р╣И**: р╣Бр╕кр╕Фр╕Зр╕зр╕▒р╕Щр╕Чр╕╡р╣Ир╣Гр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕ар╕▓р╕йр╕▓р╣Др╕Чр╕в
- **р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Ар╕Зр╕┤р╕Щ**: р╣Бр╕кр╕Фр╕Зр╕гр╕▓р╕Др╕▓р╣Гр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕кр╕Бр╕╕р╕ер╣Ар╕Зр╕┤р╕Щр╕Ър╕▓р╕Ч

### ЁЯУД р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕З PDF
1. **Header**: р╕Кр╕╖р╣Ир╕нр╕Ър╕гр╕┤р╕йр╕▒р╕Чр╣Бр╕ер╕░р╣Вр╕ер╣Вр╕Бр╣Й
2. **р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ър╕гр╕┤р╕йр╕▒р╕Чр╣Бр╕ер╕░р╕ер╕╣р╕Бр╕Др╣Йр╕▓**: р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕▒р╣Йр╕Зр╕кр╕нр╕Зр╕Эр╣Ир╕▓р╕в
3. **р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Гр╕Ър╣Ар╕кр╕Щр╕нр╕гр╕▓р╕Др╕▓**: р╣Ар╕ер╕Вр╕Чр╕╡р╣И, р╕зр╕▒р╕Щр╕Чр╕╡р╣Ир╕кр╕гр╣Йр╕▓р╕З, р╕зр╕▒р╕Щр╕лр╕бр╕Фр╕нр╕▓р╕вр╕╕
4. **р╕лр╕▒р╕зр╕Вр╣Йр╕н**: р╕лр╕▒р╕зр╕Вр╣Йр╕нр╕Вр╕нр╕Зр╣Гр╕Ър╣Ар╕кр╕Щр╕нр╕гр╕▓р╕Др╕▓
5. **р╕Хр╕▓р╕гр╕▓р╕Зр╕гр╕▓р╕вр╕Бр╕▓р╕г**: р╣Бр╕кр╕Фр╕Зр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╣Бр╕ер╕░р╕Ър╕гр╕┤р╕Бр╕▓р╕г
6. **р╕кр╕гр╕╕р╕Ыр╕гр╕▓р╕Др╕▓**: р╕гр╕▓р╕Др╕▓р╕гр╕зр╕б, р╕кр╣Ир╕зр╕Щр╕ер╕Ф, р╕ар╕▓р╕йр╕╡, р╕гр╕▓р╕Др╕▓р╕гр╕зр╕бр╕Чр╕▒р╣Йр╕Зр╕кр╕┤р╣Йр╕Щ
7. **р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕В**: р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕Вр╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щр╣Бр╕ер╕░р╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕бр╕нр╕Ъ
8. **р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕**: р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б (р╕Цр╣Йр╕▓р╕бр╕╡)
9. **р╕ер╕▓р╕вр╣Ар╕Лр╣Зр╕Щ**: р╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╕кр╕│р╕лр╕гр╕▒р╕Ър╕ер╕▓р╕вр╣Ар╕Лр╣Зр╕Щр╕ер╕╣р╕Бр╕Др╣Йр╕▓р╣Бр╕ер╕░р╕Ьр╕╣р╣Йр╣Ар╕кр╕Щр╕нр╕гр╕▓р╕Др╕▓
10. **Footer**: р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╣Бр╕ер╕░р╕зр╕▒р╕Щр╕Чр╕╡р╣Ир╕кр╕гр╣Йр╕▓р╕З

## ЁЯЪА р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### API Endpoint
```
GET /api/quotations/[id]/pdf
```

### р╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Йр╣Гр╕Щ Frontend
```typescript
const handleDownloadPDF = async (quotation: Quotation) => {
  try {
    const response = await fetch(`/api/quotations/${quotation._id}/pdf`, {
      method: 'GET',
    })

    if (!response.ok) {
      throw new Error('р╣Ар╕Бр╕┤р╕Фр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Фр╣Гр╕Щр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З PDF')
    }

    const blob = await response.blob()
    const url = window.URL.createObjectURL(blob)
    const a = document.createElement('a')
    a.href = url
    a.download = `р╣Гр╕Ър╣Ар╕кр╕Щр╕нр╕гр╕▓р╕Др╕▓_${quotation.quotationNumber}.pdf`
    document.body.appendChild(a)
    a.click()
    window.URL.revokeObjectURL(url)
    document.body.removeChild(a)
    
    toast.success('р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф PDF р╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕вр╣Бр╕ер╣Йр╕з')
  } catch (error) {
    console.error('Error downloading PDF:', error)
    toast.error('р╣Ар╕Бр╕┤р╕Фр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Фр╣Гр╕Щр╕Бр╕▓р╕гр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф PDF')
  }
}
```

## ЁЯФз р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕З

### р╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ Font
р╣Бр╕Бр╣Йр╣Др╕Вр╣Гр╕Щ `src/utils/pdfUtils.ts`:
```typescript
@import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');

body {
    font-family: 'Sarabun', 'Noto Sans Thai', 'Tahoma', sans-serif;
}
```

### р╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕кр╕╡
р╣Бр╕Бр╣Йр╣Др╕В CSS variables р╣Гр╕Щ `src/utils/pdfUtils.ts`:
```css
.header h1 {
    color: #1e40af; /* р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕кр╕╡р╕лр╕▒р╕зр╕Вр╣Йр╕н */
}

.company-info {
    border-left: 5px solid #2563eb; /* р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕кр╕╡р╕Вр╕нр╕Ъ */
}
```

### р╕Бр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕бр╣Вр╕ер╣Вр╕Бр╣Й
р╣Бр╕Чр╕Щр╕Чр╕╡р╣И SVG р╣Гр╕Щ `src/utils/pdfUtils.ts`:
```html
<img src="data:image/svg+xml;base64,YOUR_BASE64_LOGO" alt="Logo" class="logo">
```

## ЁЯУБ р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М

```
src/
тФЬтФАтФА app/
тФВ   тФФтФАтФА api/
тФВ       тФФтФАтФА quotations/
тФВ           тФФтФАтФА [id]/
тФВ               тФФтФАтФА pdf/
тФВ                   тФФтФАтФА route.ts          # API endpoint
тФЬтФАтФА utils/
тФВ   тФФтФАтФА pdfUtils.ts                       # Utility functions
тФФтФАтФА public/
    тФФтФАтФА fonts/
        тФФтФАтФА README.md                      # Font documentation
```

## ЁЯРЫ р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓

### р╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╕Юр╕Ър╕Ър╣Ир╕нр╕в

1. **Font р╣Др╕бр╣Ир╣Бр╕кр╕Фр╕Зр╕Ьр╕е**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕нр╕┤р╕Щр╣Ар╕Чр╕нр╕гр╣Мр╣Ар╕Щр╣Зр╕Х
   - р╣Ар╕Юр╕┤р╣Ир╕б timeout р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Вр╕лр╕ер╕Ф font

2. **р╕ар╕▓р╕йр╕▓р╣Др╕Чр╕вр╣Бр╕кр╕Фр╕Зр╣Ар╕Ыр╣Зр╕Щр╕Бр╕ер╣Ир╕нр╕З**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ charset р╣Гр╕Щ HTML
   - р╣Гр╕Кр╣Й font р╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ър╕ар╕▓р╕йр╕▓р╣Др╕Чр╕в

3. **PDF р╣Др╕бр╣Ир╕кр╕гр╣Йр╕▓р╕З**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Puppeteer installation
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ memory р╣Бр╕ер╕░ disk space

### р╕Бр╕▓р╕г Debug
```typescript
// р╣Ар╕Юр╕┤р╣Ир╕б logging р╣Гр╕Щ pdfUtils.ts
console.log('Generating PDF for quotation:', quotation.quotationNumber);
console.log('HTML generated:', html.substring(0, 200) + '...');
```

## ЁЯФТ Security

- р╣Гр╕Кр╣Й environment variables р╕кр╕│р╕лр╕гр╕▒р╕Ъ sensitive data
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕Бр╣Ир╕нр╕Щр╕кр╕гр╣Йр╕▓р╕З PDF
- р╣Др╕бр╣Ир╣Ар╕Ыр╕┤р╕Фр╣Ар╕Ьр╕вр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ар╕▓р╕вр╣Гр╕Щр╣Гр╕Щ error messages

## ЁЯУК Performance

- **Font Loading**: р╕гр╕н 2 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡р╣Гр╕лр╣Й font р╣Вр╕лр╕ер╕Фр╣Ар╕кр╕гр╣Зр╕И
- **Memory Management**: р╕Ыр╕┤р╕Ф browser р╕лр╕ер╕▒р╕Зр╕кр╕гр╣Йр╕▓р╕З PDF р╣Ар╕кр╕гр╣Зр╕И
- **Caching**: р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Юр╕┤р╣Ир╕б caching р╕кр╕│р╕лр╕гр╕▒р╕Ъ PDF р╕Чр╕╡р╣Ир╕кр╕гр╣Йр╕▓р╕Зр╣Бр╕ер╣Йр╕з

## ЁЯЪА р╕Бр╕▓р╕гр╕Юр╕▒р╕Тр╕Щр╕▓р╕Хр╣Ир╕н

### Features р╕Чр╕╡р╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Юр╕┤р╣Ир╕бр╣Др╕Фр╣Й
1. **Template System**: р╕гр╕░р╕Ър╕Ъ template р╕кр╕│р╕лр╕гр╕▒р╕Ъ PDF р╕лр╕ер╕▓р╕вр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ъ
2. **Watermark**: р╣Ар╕Юр╕┤р╣Ир╕б watermark р╕Ър╕Щ PDF
3. **Digital Signature**: р╣Ар╕Юр╕┤р╣Ир╕бр╕ер╕▓р╕вр╣Ар╕Лр╣Зр╕Щр╕Фр╕┤р╕Ир╕┤р╕Чр╕▒р╕е
4. **Batch Generation**: р╕кр╕гр╣Йр╕▓р╕З PDF р╕лр╕ер╕▓р╕вр╣Др╕Яр╕ер╣Мр╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Щ
5. **Custom Styling**: р╕гр╕░р╕Ър╕Ър╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕Зр╕кр╕╡р╣Бр╕ер╕░р╕Яр╕нр╕Щр╕Хр╣Мр╣Бр╕Ър╕Ъ dynamic

### р╕Бр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕б Template р╣Гр╕лр╕бр╣И
1. р╕кр╕гр╣Йр╕▓р╕Зр╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╣Гр╕лр╕бр╣Ир╣Гр╕Щ `pdfUtils.ts`
2. р╣Ар╕Юр╕┤р╣Ир╕б interface р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣И
3. р╕кр╕гр╣Йр╕▓р╕З HTML template р╣Гр╕лр╕бр╣И
4. р╣Ар╕Юр╕┤р╣Ир╕б API endpoint р╣Гр╕лр╕бр╣И

---

## ЁЯУЮ р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╣Ир╕н

р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ыр╕▒р╕Нр╕лр╕▓р╕лр╕гр╕╖р╕нр╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕гр╕░р╕Ър╕Ъ PDF р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Чр╕╡р╕бр╕Юр╕▒р╕Тр╕Щр╕▓
