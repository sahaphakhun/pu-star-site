# แผนงานโดยคร่าว (UI ใช้ข้อมูลจริง + ความเข้ากันระบบ)

## เป้าหมาย
- ทุกหน้าใน `features/jubili` และ `adminb2b` ใช้ API จริงทั้งหมด (เลิก mock/localStorage)
- `assignedTo/ownerId` เก็บเป็น `adminId` และลายเซ็นมาจากแอดมินคนนั้นจริง
- ฟอร์ม/รายงาน/พิมพ์เอกสารใช้งานได้จริง ไม่ใช่ UI เปล่า
- ระบบทำงานร่วมกันได้ ไม่มีข้อมูลซ้ำซ้อน/ชนกัน

## ขอบเขตหลัก
- ใบเสนอราคา/ใบสั่งขาย: ฟอร์ม + หน้า view/print + signature
- ลูกค้า/โครงการ/โอกาส: ที่อยู่จริง + ค้นหา/เลือกจากข้อมูลจริง
- รายงาน/WMS: ใช้ API จริงและมี auth guard
- ลบ/ลด mock และ localStorage ที่ไม่จำเป็น

## ลำดับงาน (คร่าว ๆ)
### เฟส 1: ยืนยันมาตรฐานข้อมูลและสิทธิ์
- ยืนยันมาตรฐาน auth (cookie vs bearer) ให้ทุกหน้าใช้แบบเดียวกัน
- เพิ่ม auth guard ให้ API ใหม่ที่เปิด public
- เตรียม script/migration สำหรับ `assignedTo/ownerId` ให้เป็น `adminId`

### เฟส 2: ใบสั่งขายครบวงจร
- เพิ่มหน้า View/Print ใบสั่งขาย + PDF (โครงเหมือนใบเสนอราคา)
- ผูกลายเซ็นแอดมินตามผู้รับผิดชอบ
- ทำที่อยู่จัดส่งให้ครบ (AddressAutocomplete + shipToSameAsCustomer)

### เฟส 3: เก็บกวาด mock/localStorage
- ปิด/ลบ DataContext + mockData ที่ไม่ใช้
- ตัด localStorage ที่เป็น saved filters หรือย้ายขึ้น backend
- ลบหน้า test ที่ไม่ใช้ใน production (ถ้าต้องการ)

### เฟส 4: ตรวจความเข้ากันระบบและลดซ้ำซ้อน
- ตรวจแหล่งข้อมูลซ้ำ (assignedTo, ownerId, team, role)
- รวมรูปแบบ response API ให้คงที่ (`{ data }` vs array)
- ทดสอบ flow หลัก: สร้างลูกค้า → ใบเสนอราคา → ใบสั่งขาย → รายงาน

### เฟส 5: QA/UX ที่เหลือ
- เพิ่ม empty/error state ที่จำเป็น
- ปรับปุ่ม/เมนูที่เป็น UI เปล่า (ซ่อนหรือเชื่อม action)
- ตรวจ performance ของ `thaiAddressData` (lazy-load ถ้าจำเป็น)

## สิ่งที่ต้องตัดสินใจ/ยืนยัน
- จะใช้ auth แบบ cookie-only หรือรองรับทั้ง cookie + bearer
- ตำแหน่งลายเซ็นในใบสั่งขายต้องเหมือนใบเสนอราคาหรือไม่
- จะเก็บ saved filters ไว้หรือย้ายไป backend
- หน้าทดสอบ (test-payment/test-ui) ควรถอดใน production หรือไม่

## เกณฑ์จบงาน (Acceptance)
- ทุกหน้าใช้ API จริง และไม่มี localStorage สำหรับข้อมูลธุรกิจ
- เอกสารพิมพ์ได้จริงพร้อมลายเซ็นตามผู้รับผิดชอบ
- ไม่มี UI ที่กดแล้วไม่ทำงาน (หรือถูกซ่อนถ้ายังไม่พร้อม)
- assignedTo/ownerId เป็น adminId ทั้งระบบและใช้งานได้จริง

## ความเสี่ยงหลัก
- ข้อมูลเดิมที่เก็บชื่อแทน adminId ทำให้ลายเซ็นไม่ตรง → ต้อง migrate
- API หลายจุดยังไม่มี auth guard → เสี่ยงเข้าถึงข้อมูลโดยไม่ตั้งใจ
- response รูปแบบไม่一致 (array vs `{ data }`) ทำให้ UI แตกเป็นบางหน้า
